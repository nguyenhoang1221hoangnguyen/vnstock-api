[build]
builder = "dockerfile"
dockerfilePath = "Dockerfile"

[deploy]
numReplicas = 1
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
healthcheckPath = "/health"
healthcheckTimeout = 100

# VNStock API Service
[[services]]
name = "vnstock-api"
source = "."

[services.build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[services.deploy]
startCommand = "uvicorn app.main:app --host 0.0.0.0 --port 8000"

# n8n Service (optional - deploy riêng khuyến nghị hơn)
# [[services]]
# name = "n8n"
# image = "n8nio/n8n:latest"
#
# [services.deploy]
# environmentVariables = [
#   "N8N_BASIC_AUTH_ACTIVE=true",
#   "N8N_BASIC_AUTH_USER=admin",
#   "N8N_BASIC_AUTH_PASSWORD=change-this-password",
#   "N8N_PORT=5678",
#   "N8N_PROTOCOL=https",
#   "GENERIC_TIMEZONE=Asia/Ho_Chi_Minh"
# ]
